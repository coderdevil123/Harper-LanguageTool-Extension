console.log("Background loaded üöÄ");chrome.runtime.onMessage.addListener((t,e,o)=>{var s,c;const n=(s=e==null?void 0:e.tab)==null?void 0:s.id;if(t.type==="USER_TEXT")return i(t.payload.text).then(a=>{chrome.tabs.sendMessage(n,{type:"COMBINED_RESULTS",payload:a})}),o(!0),!0;if(t.type==="GET_SUGGESTIONS"){const a=t.payload.issue;let r=[];return a.replacements&&(r=a.replacements.map(l=>l.value)),a.suggestions&&(r=a.suggestions),chrome.tabs.sendMessage(n,{type:"SHOW_SUGGESTIONS",payload:{text:a.text||((c=a.context)==null?void 0:c.text),suggestions:r,position:t.payload.position}}),o(!0),!0}if(t.type==="APPLY_SUGGESTION")return chrome.tabs.sendMessage(n,{type:"APPLY_SUGGESTION",payload:{replacement:t.payload.replacement}}),o(!0),!0});async function i(t){return{grammar:await u(t),harper:{tone:[],terminology:[]}}}async function u(t){try{const e=await fetch("http://10.10.10.36:8081/v2/check",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({text:t,language:"en-US"})});if(!e.ok)throw new Error(`LT server responded with ${e.status}`);return(await e.json()).matches||[]}catch(e){return console.error("LanguageTool error:",e),console.warn("‚ö†Ô∏è LanguageTool server not available at http://10.10.10.36:8081"),[]}}
